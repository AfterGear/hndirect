<!DOCTYPE html>
<html>
    <style>@import url("projectpage.css");</style>
    <script>
        let curFullscreenScreenshot = 0;
        let screenshots = [];

        function toggleFullscreenScreenshots() {
            const s = document.getElementById("fullscreenscreens");
            s.style.visibility = s.style.visibility == "visible" ? "hidden" : "visible"; 
            setFullscreenScreenshot(0);
        }

        function setFullscreenScreenshot(index) {
            curFullscreenScreenshot = index;
            const s = document.getElementById("fullscreen_screen");
            s.setAttribute("src", screenshots[index]);
        }

        function changeFullscreenScreenshot(ind) {
            curFullscreenScreenshot += ind;
            if (curFullscreenScreenshot < 0)
                curFullscreenScreenshot = screenshots.length - 1;
            else if (curFullscreenScreenshot >= screenshots.length)
                curFullscreenScreenshot = 0;

            setFullscreenScreenshot(curFullscreenScreenshot);
        }

        window.onload = function() {
            const title = document.getElementById("title");
            const description = document.getElementById("description");
            const devname = document.getElementById("devname");
            const devpicture = document.getElementById("devpicture");
            // const gamejoltwidget = document.getElementById("gamejoltwidget");
            const projscreens = document.getElementById("projscreens");
            const devscreds = document.getElementById("devscreds");
            const addinfo = document.getElementById("addinfo");
            const fullscreen_screen = document.getElementById("fullscreen_screen");

            const params = new URLSearchParams(document.URL);
            const datafile = params.values().next().value;

            fetch('../config/projects/' + datafile).then(response => response.json())
            .then(data => {
                title.innerHTML = data.title;
                description.innerHTML = data.description;
                devname.innerHTML = data.developerdata.developerteamname;
                devpicture.setAttribute("src", data.developerdata.developerlogo);
                // gamejoltwidget.setAttribute("src", "https://widgets.gamejolt.com/package/v1?key=" + data.gamejoltwidgetkey);
                projscreens.setAttribute("src", data.screenshots[0]);

                for (let i = 0; i < data.developerdata.credits.length; i++) {
                    const p = document.createElement("p");
                    p.innerHTML = data.developerdata.credits[i];
                    devscreds.appendChild(p);
                }

                for (let i = 0; i < data.links.length; i++) {
                    const a = document.createElement("a");
                    a.innerHTML = data.links[i].title;
                    a.href = data.links[i].link;
                    a.target = "_blank";
                    addinfo.appendChild(a);
                    const br = document.createElement("br");
                    addinfo.appendChild(br);
                }

                fullscreen_screen.setAttribute("src", data.screenshots[0]);
                screenshots = data.screenshots;
                document.body.style.visibility = "visible";
            })
            .catch(error => console.error('Error loading JSON:', error));
        }
    </script>
    <body>
        <main>
            <div id="top">
                <div>
                    <div id="titlediv">
                        <div>
                            <p id="title">Project title</p>
                            <p id="description">Project description</p>
                        </div>
                        <div id="devsect">
                            <img id="devpicture" src="../../../sprites/discord-alt.webp" alt="dev_picture">
                            <p id="devname">Devs team name</p>
                        </div>
                    </div>
                    <div id="creds">
                        <div id="devscreds">
                            <p style="padding-bottom: 10px; font-size: 24px;">Dev team:</p>
                        </div>
                        <div id="addinfo">
                            <p style="padding-top: 20px; padding-bottom: 10px; font-size: 24px;">Links: </p>
                        </div>
                    </div>
                </div>
                <div id="screenshotdiv">
                    <img id="projscreens" src="../../../sprites/HNDirectLogo.webp" alt="projscreen" onclick="toggleFullscreenScreenshots()">
                </div>
            </div>
            <!-- <div id="gamejoltdiv">
                <iframe id="gamejoltwidget" src="https://widgets.gamejolt.com/package/v1?key=" frameborder="0" width="500px" height="245px"></iframe>
            </div> -->
        </main>
        <section id="fullscreenscreens">
            <div id="fullscreenscreensbg" onclick="toggleFullscreenScreenshots()"></div>
            <img class="changescreenbtn" src="../images/Logo_Arrow2.webp" onclick="changeFullscreenScreenshot(-1)" style="transform: rotate(180deg)">
            <img id="fullscreen_screen" src="" alt="sigma">
            <img class="changescreenbtn" src="../images/Logo_Arrow2.webp" onclick="changeFullscreenScreenshot(1)">
        </section>
    </body>
</html>
